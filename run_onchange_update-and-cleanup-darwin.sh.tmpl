#!/usr/bin/env bash
# Last update: {{ now | date "2006-01-02" }}

set -euo pipefail

echo "ðŸ”„ Starting system maintenance..."

if ! command -v brew &> /dev/null; then
    echo "âš ï¸  Homebrew not installed, skipping"
    exit 0
fi

echo ""
echo "ðŸ“¦ Updating Homebrew..."
brew update

echo ""
echo "â¬†ï¸  Upgrading packages..."
brew upgrade

echo ""
echo "â¬†ï¸  Upgrading casks..."
brew upgrade --cask --greedy

echo ""
echo "ðŸ§¹ Cleaning up old versions..."
brew cleanup -s

echo ""
echo "ðŸ” Running diagnostics..."
brew doctor || true

echo ""
echo "ðŸ“Š Cache statistics:"
du -sh "$(brew --cache)" 2>/dev/null || echo "Cache empty"

echo ""
echo "âœ… Maintenance completed successfully!"
